{"content": "## 0x00.\u73af\u5883\r\n\u7cfb\u7edf:\uff1aWINXP SP3\r\n\r\n\u5f71\u54cd\u8f6f\u4ef6\uff1aVMware-ovftool-2.1.0-467744-win-i386\r\n\r\n## 0x01.\u6210\u56e0\r\n\u672a\u8fc7\u6ee4\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u5bfc\u81f4%n\u5199\u5165\u6808\u4e0a\u5173\u952e\u6570\u636e\r\n\r\n## 0x02.\u8981\u70b9\r\n\r\n##### 1.\u5982\u4f55\u5b9a\u4f4d\u5173\u952e\u70b9\uff1f\r\n\u4ece\u5d29\u6e83\u70b9\u5f00\u59cb\u4e0d\u597d\u5206\u6790\uff0c\u6808\u4e5f\u88ab\u7834\u574f\u4e86\uff0c\u5229\u7528windbg x\u547d\u4ee4\u5f88\u597d\u5b9a\u4f4d\uff0c\u5982\u4e0b\r\n```c\r\n0:000> x *!*basic_ostream*operator<<*\r\n7848e3fd MSVCP90!std::basic_ostream<char,std::char_traits<char> >::operator<< (<no parameter info>)\r\n7848e3fd MSVCP90!std::basic_ostream<char,std::char_traits<char> >::operator<< (<no parameter info>)\r\n7848e3fd MSVCP90!std::basic_ostream<unsigned short,std::char_traits<unsigned short> >::operator<< (<no parameter info>)\r\n7848e3fd MSVCP90!std::basic_ostream<wchar_t,std::char_traits<wchar_t> >::operator<< (<no parameter info>)\r\n7848e3fd MSVCP90!std::basic_ostream<unsigned short,std::char_traits<unsigned short> >::operator<< (<no parameter info>)\r\n...\r\n```\r\n\u5168\u90e8\u4e0b\u65ad\uff0c\u9047\u5230\u521a\u5f00\u59cb\u7ecf\u5e38\u65ad\u4e0b\u7684\u53d6\u6d88\u8be5\u65ad\u70b9\uff0c\u6392\u9664\u51e0\u6b21\u540e\u627e\u5230\u5173\u952e\u8f93\u51fa\u51fd\u65707848e503\uff0c\u968f\u5373\u627e\u5230\u5173\u952e\u51fd\u6570sub_47E7B0\r\n\r\n##### 2.\u600e\u4e48\u83b7\u5f97\u63a7\u5236\u6743\u7684\uff1f\r\n\u901a\u8fc7\u641c\u7d22\u5b57\u7b26\uff0c\u627e\u5230\u5199\u5165%hn\u7684\u6307\u9488\u56fa\u5b9a\u4e3aebp+50\r\n```c\r\n0:000> dd ebp+50\r\n0012fc6c  00680592 00000004 0012ff50 004184f4\r\n0012fc7c  00cd5a38 02c9b9f8 5f49b106 016138e0\r\n0012fc8c  00000002 00000000 029946f0 00000000\r\n0012fc9c  00000100 0299482c 005ee3f6 00000000\r\n0012fcac  0000000f 5f49b2e2 02994400 01e50000\r\n0012fcbc  0299459c 005ee41e 00000000 0000000f\r\n0012fccc  00000003 72507000 636f746f 00006c6f\r\n0012fcdc  0012fcc4 00000000 0000000f 7c930040\r\n0:000> k\r\nChildEBP RetAddr  \r\nWARNING: Stack unwind information not available. Following frames may be wrong.\r\n0012fc1c 0045637e ovftool+0x7ea31\r\n0012fc74 004184f4 ovftool+0x5637e\r\n0012ff50 004186f4 ovftool+0x184f4\r\n0012ff7c 005e82ff ovftool+0x186f4\r\n0012ffc0 7c817067 ovftool+0x1e82ff\r\n0012fff0 00000000 kernel32!BaseProcessStart+0x23\r\n```\r\n\u53ef\u4ee5\u770b\u5230\u7b2c\u56db\u6b21ret\u65f6\u5c06\u83b7\u5f97\u63a7\u5236\u6743\r\n\r\n##### 3.\u5982\u4f55\u5229\u7528\uff1f\r\n\u901a\u8fc7\u589e\u957f\u6570\u636e\uff0c\u4f7f\u5730\u5740\u53ef\u9884\u6d4b\uff0c\u4f7f\u5f97\u7b2c\u56db\u6b21RET\u5230ROP+SHELLCODE\u7684\u5730\u5740\uff0c\u5b8c\u6210\u5229\u7528", "title": "CVE-2012-3569\u5206\u6790", "tags": "Exploit FormatString"}