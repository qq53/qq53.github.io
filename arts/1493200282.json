{"title": "CVE-2012-1876\u5206\u6790", "content": "# \u73af\u5883\r\n\u53d7\u5f71\u54cd\u8f6f\u4ef6\uff1a Microsoft Internet Explorer 6 through 9, and 10 Consumer Preview<br />\r\n\u8c03\u8bd5\u73af\u5883: XP SP3\u4e2d\u6587\u7248 + Internet Explorer 8.0.6001.18702\r\n\r\n# \u8981\u70b9\u8bb0\u8981\r\n\u5e38\u89c4\u5206\u6790\u5185\u5bb9\u5c31\u4e0d\u5199\u4e86\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u5206\u6790\u6587\u7ae0\uff0c\u8fd9\u91cc\u4e3b\u8981\u8bb0\u5f55\u5206\u6790\u8981\u70b9\r\n\r\n### 1.  \u7533\u8bf7\u5b57\u7b26\u4e32-6\r\n```html\r\n            // E\r\n            rra[i] = dap.substring(0, (0x100-6)/2);\r\n```\r\n![string](data/cve-2012-1876/str.png)\r\n\u53ef\u4ee5\u770b\u5230\u5b57\u7b26\u4e32\u957f\u5ea6\u548c\u7ed3\u675f\u5b57\u7b26\u5171\u53606\u4e2a\u5b57\u8282\r\n\r\n### 2. \u4e3a\u4ec0\u4e48\u8981appendChild\r\n```html\r\n            // B\r\n            var obj = document.createElement(\"button\");\r\n            div_container.appendChild(obj);\r\n```\r\n\u901a\u8fc7\u5bf9ntdll!RtlAllocateHeap\u4e0b\u65ad\uff0c\u53ef\u4ee5\u89c2\u5bdfJS\u5206\u914d\u60c5\u51b5\r\n```c\r\nalloc heap: 58 addr: 230740\r\nalloc heap: 14 addr: 30b1700\r\nalloc heap: 40 addr: 30b0330\r\nalloc heap: 20 addr: 31e1960\r\nalloc heap: 4c addr: 1f1860\r\nalloc heap: 50 addr: 1f1128\r\nalloc heap: fc addr: 325d568\r\nalloc heap: 28 addr: 1494c8\r\n\r\nalloc heap: 100 addr: 325d670\r\nalloc heap: 100 addr: 325d778\r\nalloc heap: 100 addr: 325d880\r\n```\r\n\u8fd9\u91cc\u5f15\u7528[\u300aInternet Explorer Isolated Heap\u300b](https://kbandla.github.io/posts/2014/Jun/20/Internet%20Explorer%20Isolated%20Heap.html)\uff0c\u53ef\u4ee5\u770b\u5230\r\nCButton\t58h\uff0c\u4e0a\u9762\u6211\u7684\u65e5\u5fd7\u4e5f\u770b\u5230\u7533\u8bf758\u5927\u5c0f\u7a7a\u95f4\u662f\u65e0\u6cd5\u548c3\u6b21\u7533\u8bf7100\u5927\u5c0f\u7a7a\u95f4\u8fde\u7eed\u8d77\u6765\uff0c\u5728\u7533\u8bf758\u5230\u540e\u7eed\u7533\u8bf7100\u5927\u5c0f\u95f4\u8fd8\u67097\u6b21alloc,\u5176\u4e2d\u5f53\u5927\u5c0f\u662ffc\u65f6\uff0c\u8ddf\u7533\u8bf7100\u5927\u5c0f\u7a7a\u95f4\u7684\u5730\u5740\u662f\u8fde\u7eed\u7684\uff0c\u800c\u7533\u8bf7fc\u5927\u5c0f\u6b63\u662f\u7531\u4e8eappendChild\u6240\u5f71\u54cd\u7684\r\n", "tags": "Exploit HeapOverFlow"}